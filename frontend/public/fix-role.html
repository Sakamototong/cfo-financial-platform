<!DOCTYPE html>
<html>
<head>
  <title>Fix Role Cache - CFO Platform</title>
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      max-width: 600px;
      margin: 50px auto;
      padding: 20px;
      background: #f5f5f5;
    }
    .card {
      background: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    h1 {
      color: #333;
      margin-top: 0;
    }
    button {
      background: #007bff;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 4px;
      font-size: 16px;
      cursor: pointer;
      margin: 10px 10px 10px 0;
    }
    button:hover {
      background: #0056b3;
    }
    .success {
      background: #28a745;
      padding: 15px;
      border-radius: 4px;
      color: white;
      margin: 20px 0;
      display: none;
    }
    .info {
      background: #e7f3ff;
      padding: 15px;
      border-radius: 4px;
      margin: 20px 0;
      border-left: 4px solid #007bff;
    }
    .warning {
      background: #fff3cd;
      padding: 15px;
      border-radius: 4px;
      margin: 20px 0;
      border-left: 4px solid #ffc107;
    }
    pre {
      background: #f8f9fa;
      padding: 10px;
      border-radius: 4px;
      overflow-x: auto;
    }
    .btn-danger {
      background: #dc3545;
    }
    .btn-danger:hover {
      background: #c82333;
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>üîß Fix Role Cache Issue</h1>
    
    <div class="info">
      <strong>‡∏õ‡∏±‡∏ç‡∏´‡∏≤:</strong> Frontend ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏°‡∏ô‡∏π Super Admin ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á<br>
      <strong>‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:</strong> Browser cache ‡πÄ‡∏Å‡πá‡∏ö role ‡πÄ‡∏Å‡πà‡∏≤‡πÑ‡∏ß‡πâ‡πÉ‡∏ô localStorage
    </div>

    <div class="warning">
      <strong>‚ö†Ô∏è ‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô:</strong> ‡∏Å‡∏≤‡∏£‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏à‡∏∞‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• session ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á login ‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
    </div>

    <h3>‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:</h3>
    
    <button onclick="showCurrentData()">1. ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</button>
    <button onclick="clearAndReload()" class="btn-danger">2. ‡∏•‡∏ö Cache ‡πÅ‡∏•‡∏∞ Reload</button>
    <button onclick="goToLogin()">3. ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Login</button>
    
    <div id="result" class="success"></div>
    
    <div id="currentData" style="margin-top: 20px; display: none;">
      <h3>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÉ‡∏ô localStorage:</h3>
      <pre id="dataDisplay"></pre>
    </div>
  </div>

  <script>
    function showCurrentData() {
      const data = {
        access_token: localStorage.getItem('access_token') ? '(‡∏°‡∏µ token)' : '(‡πÑ‡∏°‡πà‡∏°‡∏µ)',
        tenant_id: localStorage.getItem('tenant_id'),
        user_role: localStorage.getItem('user_role'),
        user_email: localStorage.getItem('user_email'),
        is_super_admin: localStorage.getItem('is_super_admin')
      };
      
      document.getElementById('dataDisplay').textContent = JSON.stringify(data, null, 2);
      document.getElementById('currentData').style.display = 'block';
    }

    function clearAndReload() {
      if (confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? ‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á login ‡πÉ‡∏´‡∏°‡πà')) {
        // Clear all localStorage
        localStorage.clear();
        
        // Show success message
        const result = document.getElementById('result');
        result.textContent = '‚úÖ ‡∏•‡∏ö cache ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏Å‡∏≥‡∏•‡∏±‡∏á redirect ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ login...';
        result.style.display = 'block';
        
        // Redirect to login after 2 seconds
        setTimeout(() => {
          window.location.href = '/login';
        }, 2000);
      }
    }

    function goToLogin() {
      window.location.href = '/login';
    }

    // Auto-show current data on load
    window.onload = showCurrentData;
  </script>
</body>
</html>
