# Transfer Ownership UI Guide

## 🎨 User Interface Overview

### หน้า Users (Admin Only)

การโอนความเป็นเจ้าของแสดงอยู่ท้ายหน้า Users สำหรับ Admin เท่านั้น

---

## 📱 UI Components

### 1. แจ้งเตือนคำขอรับ (Incoming Requests)
```
┌─────────────────────────────────────────────┐
│ 📬 คำขอโอนความเป็นเจ้าของถึงคุณ           │
│ ┌─────────────────────────────────────────┐ │
│ │ จาก: current-owner@example.com         │ │
│ │ เหตุผล: ย้ายตำแหน่งงาน                 │ │
│ │ วันที่: 1 ก.พ. 2569                    │ │
│ │                                         │ │
│ │ [✅ ยอมรับ]  [❌ ปฏิเสธ]              │ │
│ └─────────────────────────────────────────┘ │
└─────────────────────────────────────────────┘
สี: พื้นหลังเหลือง (#fffbeb)
```

### 2. คำขอที่สร้างโดยคุณ (Outgoing Requests)
```
┌─────────────────────────────────────────────┐
│ 📤 คำขอโอนที่คุณสร้าง                     │
│ ┌─────────────────────────────────────────┐ │
│ │ ถึง: new-owner@example.com             │ │
│ │ เหตุผล: โอนกิจการ                      │ │
│ │ วันที่: 1 ก.พ. 2569                    │ │
│ │ สถานะ: รอการตอบรับ                     │ │
│ │                                         │ │
│ │ [🚫 ยกเลิกคำขอ]                        │ │
│ └─────────────────────────────────────────┘ │
└─────────────────────────────────────────────┘
สี: พื้นหลังฟ้า (#f0f9ff)
```

### 3. ปุ่มเริ่มการโอน
```
[🔄 เริ่มการโอนความเป็นเจ้าของ]
```

### 4. ฟอร์มโอนความเป็นเจ้าของ
```
┌─────────────────────────────────────────────┐
│ โอนความเป็นเจ้าของให้ผู้ใช้อื่น           │
│                                             │
│ อีเมลของเจ้าของใหม่ *                      │
│ [newowner@example.com                   ]  │
│                                             │
│ เหตุผล (ไม่บังคับ)                         │
│ ┌─────────────────────────────────────┐   │
│ │ เหตุผลในการโอนความเป็นเจ้าของ      │   │
│ │                                     │   │
│ └─────────────────────────────────────┘   │
│                                             │
│ [✉️ ส่งคำขอโอน]  [❌ ยกเลิก]            │
└─────────────────────────────────────────────┘
สี: พื้นหลังเทาอ่อน (#f9fafb)
```

### 5. ประวัติการโอน (Collapsible)
```
[🔽 แสดงประวัติการโอนทั้งหมด]

┌───────────────┬───────────────┬─────────────┬────────────┐
│ จาก          │ ถึง           │ สถานะ       │ วันที่     │
├───────────────┼───────────────┼─────────────┼────────────┤
│ admin@...     │ user@...      │ ✅ ยอมรับแล้ว│ 31 ม.ค.   │
│ admin@...     │ test@...      │ ❌ ปฏิเสธแล้ว│ 30 ม.ค.   │
│ admin@...     │ demo@...      │ 🚫 ยกเลิกแล้ว│ 29 ม.ค.   │
│ user@...      │ admin@...     │ ⏳ รอการตอบรับ│ 1 ก.พ.    │
└───────────────┴───────────────┴─────────────┴────────────┘
```

---

## 🎯 User Flow

### Flow 1: เริ่มการโอน (Initiator)
1. คลิก "🔄 เริ่มการโอนความเป็นเจ้าของ"
2. กรอกอีเมลของเจ้าของใหม่
3. กรอกเหตุผล (optional)
4. คลิก "ส่งคำขอโอน"
5. แสดงใน section "📤 คำขอโอนที่คุณสร้าง"
6. สามารถ "ยกเลิกคำขอ" ได้ก่อนถูกตอบรับ/ปฏิเสธ

### Flow 2: รับการโอน (Recipient)
1. เห็น notification ใน "📬 คำขอโอนความเป็นเจ้าของถึงคุณ"
2. อ่านรายละเอียด (จาก, เหตุผล, วันที่)
3. เลือก:
   - คลิก "✅ ยอมรับ" → role เปลี่ยนเป็น owner
   - คลิก "❌ ปฏิเสธ" → ระบุเหตุผล (optional) → ปฏิเสธคำขอ

---

## 🔐 Permission Requirements

- **ดู Transfer Section:** Admin role only
- **เริ่มการโอน:** Admin role + must be current owner
- **ยอมรับ/ปฏิเสธ:** ต้องเป็นผู้ที่ถูกระบุใน `new_owner_email`
- **ยกเลิก:** ต้องเป็นผู้สร้างคำขอ (current owner)

---

## 📋 Status Icons

| Icon | Status | Description |
|------|--------|-------------|
| ⏳ | pending | รอการตอบรับ |
| ✅ | accepted | ยอมรับแล้ว - การโอนสำเร็จ |
| ❌ | rejected | ปฏิเสธแล้ว - การโอนไม่สำเร็จ |
| 🚫 | cancelled | ยกเลิกแล้ว - ผู้สร้างยกเลิกคำขอ |

---

## 🎨 Color Scheme

| Element | Color | Hex Code |
|---------|-------|----------|
| Incoming Request Box | Light Yellow | `#fffbeb` |
| Outgoing Request Box | Light Blue | `#f0f9ff` |
| Form Background | Light Gray | `#f9fafb` |
| White Card | White | `#ffffff` |
| Error Message | Light Red | `#fee` with `#c00` text |
| Border | Light Gray | `#ddd` |

---

## 📱 Responsive Behavior

- ฟอร์มและ cards ใช้ full width
- Input fields ปรับขนาดตาม container
- Table แสดงแบบ responsive (อาจต้อง scroll แนวนอนบนหน้าจอเล็ก)
- Buttons จัดเรียงในแนวนอน ระยะห่าง 8px

---

## 🔄 API Integration

### Component Props:
```typescript
interface TransferOwnershipProps {
  currentUserEmail: string;      // From UserContext
  onTransferInitiated?: () => void; // Callback to reload users
}
```

### State Management:
- `showForm` - แสดง/ซ่อนฟอร์ม
- `newOwnerEmail` - อีเมลที่กรอก
- `reason` - เหตุผลที่กรอก
- `loading` - สถานะการส่งข้อมูล
- `error` - ข้อความ error
- `pendingRequests` - คำขอที่รอดำเนินการ
- `allRequests` - คำขอทั้งหมด
- `showHistory` - แสดง/ซ่อนประวัติ

---

## 🧪 Testing Checklist

- [ ] แสดง component สำหรับ admin เท่านั้น
- [ ] ซ่อน component สำหรับ non-admin
- [ ] กรอกอีเมลใหม่และส่งคำขอสำเร็จ
- [ ] แสดงคำขอรับที่ pending
- [ ] ยอมรับคำขอสำเร็จ
- [ ] ปฏิเสธคำขอสำเร็จ
- [ ] ยกเลิกคำขอที่สร้างสำเร็จ
- [ ] แสดงประวัติการโอนทั้งหมด
- [ ] Toggle show/hide ประวัติ
- [ ] แสดง error message เมื่อส่งไม่สำเร็จ
- [ ] Validation: ต้องกรอกอีเมล
- [ ] Loading state แสดงระหว่างส่งข้อมูล

---

**Last Updated:** February 1, 2026  
**Component:** `frontend/src/components/TransferOwnership.tsx`  
**Page:** `frontend/src/pages/Users.tsx`
